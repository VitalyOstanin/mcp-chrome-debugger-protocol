# Claude Memory for MCP Chrome Debugger Protocol

## Project Rules
- **ABSOLUTELY NEVER use `any` type anywhere in TypeScript code** - always use proper typing, create interfaces, use unknown with type guards, or use generic types
- **Use official types from modules instead of custom types** - import and use existing types from @modelcontextprotocol/sdk and other modules rather than creating custom interfaces
- **NEVER use emoji in code, comments, or console output** - keep all text plain and professional
- Always return JSON from MCP tools instead of user-friendly strings
- Use filePath parameter for breakpoints, not scriptId
- Maintain consistent error handling patterns
- **Apply DRY (Don't Repeat Yourself) principle everywhere except in tests** - extract common patterns, shared utilities, and reusable functions
- **Use modern ES features** - prefer const/let over var, arrow functions, async/await, destructuring, optional chaining, nullish coalescing
- **Use Node.js built-in promise-based APIs** - prefer `node:timers/promises` over setTimeout, `node:fs/promises` over callback fs methods
- **ABSOLUTELY MANDATORY: Use modern Promise-based timers with async/await** - always use `import { setTimeout } from "node:timers/promises"` and async/await patterns instead of callback-based setTimeout
- **Follow ESLint rules strictly** - write code that passes linting without warnings, use `??` instead of `||`, avoid unused variables, prefer explicit types
- **NEVER edit generated files directly** - `src/generated/protocol-requirements.ts` is auto-generated by `scripts/analyze-protocol.cjs`. Always modify the generator script, not the generated file

## Project Structure
- Main MCP server: `src/mcp-server.ts`
- Debugger manager: `src/debugger-manager.ts` 
- Tools registry: `src/tools-registry.ts` (defines tool schemas)
- Tests: `tests/integration/` for integration tests
- Test fixtures: `tests/fixtures/test-app/` contains a TypeScript test application

## Key Implementation Details
- Breakpoints use `filePath` parameter and `setBreakpointByUrl` CDP method
- Logpoints are implemented as conditional breakpoints with console.log expressions
- Search functionality uses ripgrep to find compiled files
- All tools should return structured JSON data, not user-friendly messages

## Testing
- Integration tests run with `npm run test:integration`
- Test setup automatically builds both main project and test application
- Tests use a real Node.js process with debugger enabled

## Development Workflow
**MANDATORY: After ANY code changes, always run this validation cycle:**
1. `npm run lint:fix` - Auto-fix linting issues
2. `npm run lint` - Check for remaining linting errors
3. `npm run build` - Ensure TypeScript compilation succeeds
4. **Repeat steps 1-3 until both lint and build are successful**
5. Integration tests (`npm run test:integration`) are optional but recommended for major changes

## Current Status  
- Project uses ES modules with proper TypeScript configuration
- All tools return standardized JSON responses: `{success: true, data: {...}}` or `{success: false, error: "...", code: "...", details: {...}}`
- Integration tests: 98.75% success rate (79/80 tests pass)
- Linting and build: âœ… Clean and successful
- Error handling: Unified with `withErrorHandling` utility pattern
- Source map integration: Advanced TypeScript/JavaScript mapping support