# Repository Guidelines

## Contributor Notes
- Read `CLAUDE.md` first for project-specific rules and workflow.
- Project language: English (code, comments, docs, commits).
- After making changes, run `npm run lint:fix` locally before commits.

## Project Structure & Module Organization
- `src/`: TypeScript sources for the MCP server, DAP client, CDP transport, and utilities.
  - Key modules: `mcp-server.ts`, `dap-client.ts`, `nodejs-debug-adapter.ts`, `cdp-transport.ts`, `source-map-resolver.ts`.
- `tests/`: Jest tests (unit + integration), with fixtures in `tests/fixtures/`.
- `dist/`: Compiled JS (generated by `npm run build`).
- `scripts/`: Local helper scripts (install, dev, test).

## Build, Test, and Development Commands
- `npm run build`: Compile TypeScript to `dist/`.
- `npm start`: Run compiled server from `dist/index.js`.
- `npm run dev`: Type-check/watch compile during development.
- `npm run dev:server`: Build then start the server.
- `npm test`: Run unit tests (`jest.config.cjs`).
- `npm run test:integration`: Run integration tests (`jest.config.integration.cjs`).
- `npm run lint` / `npm run lint:fix`: Lint and auto-fix code style.
- `npm run dev:test` / `npm run dev:test:ts`: Dev helper scripts for local testing.

## Coding Style & Naming Conventions
- Language: TypeScript (ES modules). Files use kebab-case (e.g., `dap-client.ts`).
- Linting: ESLint (see `eslint.config.mjs`). Use nullish coalescing (`??`), optional chaining (`?.`).
- Blank lines: required before `return`, before/after a block of `const/let/var`; never between adjacent declarations.
- Prefer `const`, modern ES syntax, and type-only imports/exports where appropriate.

## Testing Guidelines
- Framework: Jest. Keep tests near related features under `tests/`.
- Naming: `*.test.ts` with descriptive, behavior-focused test names.
- Run full suite locally (`npm test`, `npm run test:integration`) before opening PRs.
- After substantial changes: run integration tests selectively for affected specs to iterate faster, for example:
  - `npm run test:integration -- tests/integration/your-feature.test.ts`
  - `npm run test:integration -- -t "your test name pattern"`
- If no tests cover the change (new functionality), propose creating a new integration or unit test and add it alongside the feature.

## Commit & Pull Request Guidelines
- Commits: Imperative, concise subject; describe why and what (scope-based messages welcome).
- PRs: Include purpose, summary of changes, testing notes, and links to issues. Add reproduction steps and screenshots/logs for debugger flows where useful.

## Security & Configuration Tips
- Do not commit secrets or environment-specific tokens. Scripts may touch local debug ports (9229+); verify before sharing logs.
- Keep third-party updates minimal and focused; prefer small, reviewable PRs.

## Example
- Build + test locally:
  - `npm run lint && npm run build && npm test && npm run test:integration`

## Mermaid Diagram Tips
- Use quoted labels when you need parentheses: `A["function(params)"]`.
- Avoid curly braces and commas in sequence message labels; prefer short, plain text.
- Keep detailed sequence diagrams narrow (short participant names, concise messages) so they fit on screen.
